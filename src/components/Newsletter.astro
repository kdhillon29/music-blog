<div class="flex flex-col gap-3 text-neutral-200 items-center">
  <div>
    <h2 class="text-white text-xl font-semibold max-sm:text-sm">
      Subscribe to Our Newsletter!
    </h2>
    <p class="text-muted-foreground text-sm max-sm:hidden">
      Join the community and learn from Music Producers and Enthusiasts
    </p>
  </div>
  <form method="POST" action="/api/newsletter" class="flex md:max-w-xl gap-2">
    <input
      type="email"
      name="email"
      required
      aria-required="true"
      placeholder="Enter your Email"
      id="email"
      class="bg-neutral-300 :focus:border-teal-500 max-sm:w-2/3 shadow-sm text-neutral-200 rounded-lg md:w-full p-2 md:px-4 md:text-lg"
    />

    <button
      id="newsletterBtn"
      type="submit"
      class="bg-primary/70 text-white p-3 md:px-6 rounded-xl md:text-2xl"
    >
      Subscribe
    </button>
  </form>
</div>

<script is:inline data-astro-rerun>
  window.onload = () => {
    console.log("newsletter script");
    function validateEmail(email) {
      const re =
        /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
      return re.test(String(email).toLowerCase());
    }
    const newsletterBtn = document.querySelector("#newsletterBtn");
    const email = document.querySelector("#email");
    newsletterBtn?.addEventListener("click", () => {
      console.log("clicked");
      console.log(email.value);
      console.log(validateEmail(email.value));
      if (validateEmail(email.value)) {
        newsletterBtn.innerHTML = "Sending..";
      }
    });
  };
</script>
